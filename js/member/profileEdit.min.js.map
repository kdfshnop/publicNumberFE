{"version":3,"sources":["member/profileEdit.min.js"],"names":["ProfileEditController","document","title","selectedTowns","addEventListeners","require","appStaticPrefix","$","upload","citypicker","cityId","val","townpicker","data","click","submit","headPortrait","attr","idCardPict","realname","trim","idCard","towns","requestData","JSON","stringify","tips","request","apiUrl","member","profileEdit","type","showLoadingTips","loadingTips","successCallback","remove","window","location","href","completeCallback","css","text","Controller","ready"],"mappings":"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","file":"profileEdit.min.js","sourcesContent":["/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n 1. 项目名称：有房有客微信CDN框架\n 2. 页面名称：profileEdit.js (个人资料编辑)\n 3. 作者：zhaohuagang@lifang.com\n -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\nclass ProfileEditController extends Controller {\n    constructor() {\n        super() ;\n        document.title = \"完善资料\";    // 设置标题\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        选择的板块信息字段\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        this.selectedTowns = \"\" ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        添加dom事件监听\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        this.addEventListeners() ;       \n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    添加dom事件监听\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    addEventListeners() {\n        require([\n            this.appStaticPrefix + \"/components/jquery.upload.min.js\" , \n            this.appStaticPrefix + \"/components/jquery.citypicker.min.js\",\n            this.appStaticPrefix + \"/components/jquery.townpicker.min.js\"\n        ] , () => {\n            $(\".upload-handler\").upload({ \"accept\" : \"image/*\" }) ;\n            $(\"#citySelector\").citypicker({\n                \"callback\": (cityId) => {\n                    $(\"#cityId\").val(cityId) ;\n                }\n            }) ;\n            $(\"#townSelector\").townpicker({\n                \"controller\" : this ,\n                \"callback\": (data) => {\n                    this.selectedTowns = data ;\n                }\n            });\n        });\n        $(\"#submit\").click(() => {\n            this.submit();\n        });\n    }\n    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n    提交数据\n    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n    submit() {\n        let headPortrait = $(\".head-portrait .upload-handler\").attr(\"data-img\") || \"\" ;\n        let idCardPict = $(\".idcard .upload-handler\").attr(\"data-img\") || \"\" ;\n        let realname = $(\"input[name='realname']\").val() ;\n        if (realname) realname = $.trim(realname) ;\n        let idCard = $(\"input[name='idCard']\").val() ;\n        if (idCard) idCard = $.trim(idCard) ;\n        let cityId = $(\"#cityId\").val() ;\n        if (cityId) cityId = $.trim(cityId) ;\n        let towns = this.selectedTowns ;\n        let requestData = {\n            \"pic\" : headPortrait ,\n            \"name\" : realname ,\n            \"identity\" : idCard ,\n            \"idcard\" : idCardPict ,\n            \"cityId\" : cityId ,\n            \"district\" : JSON.stringify(towns) ,     // 这边有个问题 不把towns转成JSON字符串的话 传过去的参数是district[0].towns[0].id等,就是把数组拆分了\n            \"mobile\" : $(\"input[name=tel]\").val() ,\n            \"openId\" : $(\"input[name=openId]\").val(),\n            \"agentId\" : $(\"input[name=agentId]\").val(),\n            \"state\": $(\"input[name=state]\").val()\n        } ;\n        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n        数据校验\n        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n        if ( ! headPortrait) {\n            $.tips( \"请上传您的头像！\" , 3 ) ;\n            return ;\n        }\n        if ( ! realname ) {\n            $.tips( \"请输入真实姓名！\" , 3 ) ;\n            return ;\n        }\n        if ( ! idCard ) {\n            $.tips(\"请输入身份证号！\" , 3 ) ;\n            return ;\n        }\n        if ( ! idCardPict ) {\n            $.tips(\"请上传身份证正面照！\" , 3 ) ;\n            return ;\n        }\n        if ( ! cityId ) {\n            $.tips( \"请选择城市！\" , 3 ) ;\n            return ;\n        }\n        if ( ! towns ) {\n            $.tips( \"请选择主营板块！\" , 3 ) ;\n            return ;\n        }\n        this.request( this.apiUrl.member.profileEdit , requestData , {\n            type : \"post\" ,\n            showLoadingTips : true,\n            loadingTips : \"请稍候...\",\n            successCallback : (data) => {\n                $(\"body > .tips\").remove();\n                window.location.href = \"/member/profile/result\" ;\n            },\n            completeCallback: () => {\n                $(\"#submit\").css(\"pointer-events\", \"auto\").text(\"提交\");\n            }\n        }) ;\n        $(\"#submit\").css(\"pointer-events\", \"none\").text(\"提交中...\") ;\n    }\n}\n\n/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n类的初始化\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/\n$(document).ready(function () {\n    new ProfileEditController ;\n}) ;"]}